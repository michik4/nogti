# Обновления функциональности доступности мастера

## Обзор

Заменен статичный блок "Сегодня до 20:00" на функциональный компонент, который показывает реальное расписание мастера и позволяет просматривать полное расписание.

## Внесенные изменения

### 1. Создан компонент MasterAvailability
**Файл:** `clientapp2/src/components/master-profile/MasterAvailability.tsx`

**Функциональность:**
- Загружает реальное расписание мастера на сегодня
- Показывает самое позднее время работы сегодня
- Отображает количество доступных окон
- Предоставляет кнопку для просмотра полного расписания
- Показывает статус каждого временного окна (свободно/забронировано/заблокировано)

### 2. Обновлены компоненты профиля мастера

#### DesktopProfileView.tsx
- Добавлен импорт `MasterAvailability`
- Заменен статичный блок на `<MasterAvailability masterId={master.id} />`

#### MobileProfileView.tsx
- Добавлен импорт `MasterAvailability`
- Заменен статичный блок на `<MasterAvailability masterId={master.id} />`

#### MasterProfile.tsx
- Добавлен импорт `MasterAvailability`
- Заменен статичный блок на `<MasterAvailability masterId={master.id} />`

## Функциональность компонента MasterAvailability

### Отображение доступности:
- **"Сегодня до 20:00"** - показывает самое позднее время работы сегодня
- **"Сегодня нет свободного времени"** - если нет доступных окон
- **Бейдж с количеством окон** - показывает сколько свободных окон сегодня
- **Кнопка "Расписание"** - открывает модалку с полным расписанием

### Модалка полного расписания:
- Показывает расписание на месяц вперед
- Группирует окна по дням
- Отображает статус каждого окна (свободно/забронировано/заблокировано)
- Форматирует время без секунд (HH:MM)

### API интеграция:
- `scheduleService.getMasterSchedule()` - получение расписания мастера
- Загружает расписание на сегодня для отображения доступности
- Загружает полное расписание при открытии модалки

## Визуальные улучшения

### До изменений:
- Статичный текст "Сегодня до 20:00"
- Нет информации о реальной доступности
- Нет возможности просмотреть расписание

### После изменений:
- Динамическое отображение времени работы
- Показ количества доступных окон
- Кнопка для просмотра полного расписания
- Модалка с детальным расписанием на месяц

## Технические детали

### Состояния компонента:
```typescript
const [todaySchedule, setTodaySchedule] = useState<TimeSlot[]>([]);
const [isLoading, setIsLoading] = useState(true);
const [showFullSchedule, setShowFullSchedule] = useState(false);
const [fullSchedule, setFullSchedule] = useState<ScheduleDay[]>([]);
```

### Функции:
- `getLatestWorkTime()` - получает самое позднее время работы
- `getAvailableSlotsCount()` - считает количество доступных окон
- `fetchFullSchedule()` - загружает полное расписание
- `formatTimeDisplay()` - форматирует время без секунд

### API вызовы:
```typescript
// Расписание на сегодня
const schedule = await scheduleService.getMasterSchedule(masterId, today, today);

// Полное расписание на месяц
const schedule = await scheduleService.getMasterSchedule(masterId, startDate, endDate);
```

## Статусы временных окон

- **available** - свободно для бронирования (зеленый)
- **booked** - забронировано клиентом (синий)
- **blocked** - заблокировано мастером (красный)

## Дата обновления

Обновления внесены: **2024 год** 