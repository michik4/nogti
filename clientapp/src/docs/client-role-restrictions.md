# Ограничения по ролям для действий лайка и записи

## Обзор
В системе действия лайка и записи к мастеру доступны только пользователям с ролью "client" (клиент). Для других типов пользователей (мастера, гости, неаутентифицированные) отображаются соответствующие сообщения или кнопки для входа в систему.

## Роли пользователей

### Client (Клиент)
- **Лайки**: Может ставить и убирать лайки с дизайнов
- **Запись**: Может записываться к мастерам на услуги
- **Отображение**: Активные кнопки лайка и записи

### Master (Мастер)
- **Лайки**: Не может ставить лайки (показывается сообщение "Только для клиентов")
- **Запись**: Не может записываться к другим мастерам (показывается сообщение "Только для клиентов")
- **Отображение**: Неактивные кнопки с соответствующими сообщениями

### Guest (Гость)
- **Лайки**: Предлагается зарегистрироваться как клиент
- **Запись**: Предлагается зарегистрироваться как клиент
- **Отображение**: Кнопки "Войти, чтобы лайкать" и "Войти, чтобы записаться"

### Неаутентифицированный пользователь
- **Лайки**: Предлагается войти в систему как клиент
- **Запись**: Предлагается войти в систему как клиент
- **Отображение**: Кнопки для входа в систему

## Обновленные компоненты

### DesignActions.tsx
- Основные действия на странице дизайна
- Условное отображение кнопок лайка и записи
- Разные состояния для разных типов пользователей

### MasterInfo.tsx
- Информация о мастерах на странице дизайна
- Кнопки записи к конкретному мастеру
- Проверка роли перед отображением активной кнопки

### MasterCard.tsx
- Карточки мастеров в каталоге
- Кнопки лайка и записи в мобильной и десктопной версиях
- Адаптивное отображение в зависимости от роли

### useLike.ts
- Хук для работы с лайками
- Проверка статуса лайка только для клиентов
- Предотвращение ошибок 403 для других ролей

## Логика проверки ролей

```typescript
// Проверка роли клиента
if (!isClient()) {
  if (isGuest()) {
    // Сообщение для гостей
    toast({
      title: "Требуется регистрация",
      description: "Зарегистрируйтесь как клиент, чтобы...",
      variant: "destructive"
    });
  } else if (user && 'role' in user && user.role === 'nailmaster') {
    // Сообщение для мастеров
    toast({
      title: "Недоступно для мастеров",
      description: "Действие доступно только для клиентов",
      variant: "destructive"
    });
  } else {
    // Сообщение для неаутентифицированных
    toast({
      title: "Требуется авторизация",
      description: "Войдите в систему как клиент, чтобы...",
      variant: "destructive"
    });
  }
  return;
}
```

## Стили

### CSS классы
- `.authButton` - для кнопок входа в систему
- `.disabledButton` - для неактивных кнопок мастеров
- `.bookingButton` - для активных кнопок записи клиентов

### Адаптивность
- Мобильная версия: вертикальное расположение кнопок
- Десктопная версия: горизонтальное расположение
- Полноширинные кнопки в карточках мастеров

## Сообщения для пользователей

### Лайки
- **Гости**: "Зарегистрируйтесь как клиент, чтобы ставить лайки"
- **Мастера**: "Лайки доступны только для клиентов"
- **Неаутентифицированные**: "Войдите в систему как клиент, чтобы ставить лайки"

### Запись
- **Гости**: "Зарегистрируйтесь как клиент, чтобы записаться к мастеру"
- **Мастера**: "Запись доступна только для клиентов"
- **Неаутентифицированные**: "Войдите в систему как клиент, чтобы записаться"

## Технические детали

### Проверка роли
```typescript
const { user, isClient, isGuest } = useAuth();

// Проверка в хуке лайков
if (isAuthenticated && user && 'role' in user && user.role === 'client') {
  // Проверяем статус лайка
}

// Проверка в обработчиках
if (!isClient()) {
  // Показываем соответствующее сообщение
  return;
}
```

### Условное отображение
```typescript
const renderClientActions = () => (
  // Активные кнопки для клиентов
);

const renderGuestActions = () => (
  // Кнопки входа для гостей
);

const renderMasterActions = () => (
  // Неактивные кнопки для мастеров
);
```

## Безопасность

- Проверка роли происходит как на клиенте, так и на сервере
- Серверные endpoints проверяют роль через middleware
- Предотвращение ошибок 403 через условную отправку запросов
- Graceful degradation для разных типов пользователей 