# –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## –û–±–∑–æ—Ä

–°–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `morgan` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ middleware –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è.

## –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
npm install morgan
npm install -D @types/morgan
```

## –¢–∏–ø—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Morgan)

- **Development**: –§–æ—Ä–º–∞—Ç `dev` - –∫—Ä–∞—Ç–∫–∏–π –∏ —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥
- **Production**: –§–æ—Ä–º–∞—Ç `combined` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Apache —Ñ–æ—Ä–º–∞—Ç
- **Custom**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –≤—Ä–µ–º–µ–Ω–µ–º –æ—Ç–≤–µ—Ç–∞

### 2. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

–ö–∞—Å—Ç–æ–º–Ω—ã–π middleware `requestBodyLogger` –ª–æ–≥–∏—Ä—É–µ—Ç:

- üì• –í—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã (–º–µ—Ç–æ–¥, URL, –≤—Ä–µ–º—è)
- üåê IP-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- üìã HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏ (–±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- üîç Query-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- üìÑ –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (—Å —Å–æ–∫—Ä—ã—Ç–∏–µ–º –ø–∞—Ä–æ–ª–µ–π)
- üì§ –û—Ç–≤–µ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞
- ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
NODE_ENV=development          # development | production
PORT=3000

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
ENABLE_REQUEST_LOGGING=true   # –≤–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
ENABLE_RESPONSE_LOGGING=true  # –≤–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –æ—Å–Ω–æ–≤–Ω–æ–º —Ñ–∞–π–ª–µ —Å–µ—Ä–≤–µ—Ä–∞

```typescript
import { getLogger, requestBodyLogger } from "./middleware/logger.middleware";

app.use(getLogger()); // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ª–æ–≥–≥–µ—Ä–∞
app.use(requestBodyLogger); // –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ middleware

```typescript
import { 
    successLogger,    // —Ç–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
    errorLogger,      // —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
    devLogger,        // —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    prodLogger,       // –ø—Ä–æ–¥–∞–∫—à–µ–Ω
    getLogger,        // –∞–≤—Ç–æ–≤—ã–±–æ—Ä –ø–æ NODE_ENV
    requestBodyLogger // –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
} from "./middleware/logger.middleware";
```

## –ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞

### Development —Ä–µ–∂–∏–º
```
GET /api/users 200 15.432 ms - 1024
üì• [2024-01-15T10:30:00.000Z] GET /api/users
üåê IP: ::1
üìã Headers: { "user-agent": "Mozilla/5.0...", "accept": "application/json" }
üì§ [2024-01-15T10:30:00.015Z] Response 200 - 15ms
```

### Production —Ä–µ–∂–∏–º
```
::1 - - [15/Jan/2024:10:30:00 +0000] "GET /api/users HTTP/1.1" 200 1024 "-" "Mozilla/5.0..."
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- `password` ‚Üí `***`
- `token` ‚Üí `***` 
- `access_token` ‚Üí `***`
- `authorization` –∑–∞–≥–æ–ª–æ–≤–æ–∫
- `cookie` –∑–∞–≥–æ–ª–æ–≤–∫–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏

–î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```env
ENABLE_REQUEST_LOGGING=false
ENABLE_RESPONSE_LOGGING=false
```

–≠—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ Morgan –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. 